# 超级玛丽第一关
用C语言和SDL2实现的经典超级玛丽游戏第一关

## 🎯 项目最新更新
**最新更改（2024.06.30）**：
- **完全移除sprite系统**：删除所有图片素材相关代码，使用纯SDL矩形绘制
- **格子大小调整**：从32x32调整为16x16，更精细的游戏体验
- **角色尺寸优化**：马里奥改为15x20像素，更符合角色比例
- **修复渲染卡顿**：优化浮点数渲染计算，消除角色移动时的闪回现象
- **敌人系统修复**：修正敌人消失问题，确保敌人正常显示和运行
- **代码大幅简化**：可执行文件约54KB，运行流畅稳定

## 游戏功能

### 基础功能
- 马里奥角色移动（左右键）和跳跃（空格键）
- 重力物理系统和碰撞检测
- 卷轴式摄像机跟随
- 奖励方块系统（可撞击但不再变大）

### 敌人系统 🆕
- **栗子小子（Goomba）敌人**：棕色方块敌人
- **智能移动**：敌人会在平台上左右移动，遇墙转向，避免掉下悬崖
- **踩踏机制**：从上方跳到敌人身上可以消灭敌人，马里奥会弹跳
- **伤害系统**：侧面碰撞会使马里奥受伤并失去生命
- **无敌时间**：受伤后有2秒无敌时间，期间马里奥会闪烁
- **生命系统**：马里奥有3条生命，生命用完游戏结束

### 简化视觉系统 ✨
- **纯色块显示**：使用不同颜色的矩形代表游戏元素
  - 红色：马里奥（15x20像素，更符合人物比例）
  - 棕色：栗子小子敌人（16x16）
  - 黄色：问号奖励方块（16x16）
  - 砖色：普通方块（16x16）
  - 天蓝色：背景
- **平滑渲染**：优化浮点数计算，消除移动卡顿和闪回
- **无敌闪烁**：受伤时马里奥会闪烁显示
- **高性能**：无图片加载，纯SDL绘制，运行流畅稳定

### 操作方式
- **左/右方向键**：移动马里奥
- **空格键**：跳跃
- **ESC键**：退出游戏

### 游戏目标
- 避开或踩踏敌人
- 撞击奖励方块
- 尽可能向右前进

## 编译和运行

### 依赖要求
- **仅需SDL2**：`brew install sdl2`

### 快速开始
```bash
# 1. 安装依赖（仅SDL2）
brew install sdl2

# 2. 编译游戏（三种方式任选一种）

# 方式1：使用编译脚本（推荐）
./build.sh

# 方式2：VS Code编译
# 按 Cmd+Shift+P -> "Tasks: Run Build Task"

# 方式3：手动编译
gcc -I/opt/homebrew/include/SDL2 -D_THREAD_SAFE -L/opt/homebrew/lib scripts/*.c -o mario_game -lSDL2

# 3. 运行游戏
./mario_game
```

## 📁 项目结构
```
小学期作业/
├── scripts/               # 所有源代码文件
│   ├── main.c             # 主程序和游戏循环
│   ├── mario.c/h          # 马里奥角色逻辑（简化版）
│   ├── enemy.c/h          # 敌人系统
│   ├── map.c/h            # 地图数据
│   ├── render.c/h         # SDL2渲染（纯矩形绘制）
│   ├── camera.c/h         # 摄像机系统
│   ├── blocks.c/h         # 奖励方块系统
│   └── input.c/h          # 输入处理
├── .vscode/
│   └── tasks.json         # VS Code 编译配置
├── mario_game             # 编译后的可执行文件（60KB）
└── README.md              # 本文件
```

## 🚀 技术特点
- **极简设计**：移除所有图片依赖，纯代码实现
- **小文件体积**：可执行文件仅54KB
- **高性能**：无图片加载，纯SDL几何绘制，平滑渲染
- **16x16精细格子**：比原来的32x32更精细的游戏体验
- **优化的角色比例**：马里奥15x20像素，更真实的人物比例
- **无卡顿移动**：修复渲染算法，消除角色移动闪回问题
- **代码简洁**：移除复杂的状态系统，更易理解

## 📝 学习收获
- 掌握了SDL2图形编程基础
- 实现了2D游戏物理系统
- 学会了模块化程序设计
- 理解了游戏循环和状态管理
- 实践了碰撞检测算法
- 体验了代码简化和优化的过程
- 学会了在功能和复杂度之间平衡
